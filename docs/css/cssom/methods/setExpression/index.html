<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs with-toc">
  <head>
    <meta charset="UTF-8" />
    <title>setExpression · WebPlatform Docs</title>
    <link rel="stylesheet" href="/assets/css/docs.css" />
    <link rel="stylesheet" href="/assets/css/highlight.css" />
    <link rel="shortcut icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width" />
    <!--[if lt IE 7]><script src="/bower_components/ie7-js/lib/IE7.js"></script><![endif]-->
    <!--[if lt IE 8]><script src="/bower_components/ie7-js/lib/IE8.js"></script><![endif]-->
    <!--[if lt IE 9]><script src="/bower_components/ie7-js/lib/IE9.js"></script><![endif]-->
    <!--[if lt IE 8]><link rel="stylesheet" href="/assets/css/ie7.css"><![endif]-->
    <meta property="readiness" content="In Progress" />
    
    
    <script src="/bower_components/jquery/dist/jquery.min.js"></script>
    <script src="/bower_components/vue/dist/vue.min.js"></script>
  </head>
  <body class="mediawiki ltr sitedir-ltr skin-webplatform action-view">
    <div class="readiness-state In_Progress"><p>This page is <a>In Progress</a></p></div>
    <header id="mw-head" class="noprint">
      <div class="container">
        <div id="p-logo">
            <a href="/"  title="Visit the home page"></a>
        </div>
      </div>
    </header>
    <nav id="sitenav">
    <div class="container">
      <ul class="links">
          <li><a href="/" class="active">THE DOCS</a></li>
          <li><a href="/docs/Community">CONNECT</a></li>
          <li><a href="/docs/WPD/Contributors_Guide/">CONTRIBUTE</a></li>
          <li><a href="/blog/">BLOG</a></li>
      </ul>
    </div>
    </nav>

    <div id="siteNotice">
      <div id="localNotice" dir="ltr" lang="en">
    
        <div class="notice" style="margin:10px auto; position: relative; width: 90%; max-width: 950px;">
          <div style="padding: 10px; border-radius: 4px; background-color: rgb(249, 247, 243); box-shadow: 0px 0px 1px rgb(167, 169, 172);">
            <strong>Notice:</strong>&nbsp;The WebPlatform project, supported by various stewards between 2012 and 2015, has been <b>discontinued</b>. This site is now available on <a href="https://github.com/webplatform/webplatform.github.io/">github</a>.
          </div>
        </div>
    
      </div>
    </div>

    <div id="content" class="mw-body">
      <div class="container">
        <a id="top"></a>
        <div class="tool-area">
              <div id="hierarchy-menu">
                  <ol id="breadcrumb-info" class="breadcrumbs">
                    <li><a href="/">DOCS</a></li>
                  	<li><a href="/docs/css/">css</a></li><li><a href="/docs/css/cssom/">cssom</a></li><li><a href="/docs/css/cssom/methods/">methods</a></li><li><a href="/docs/css/cssom/methods/setExpression/">setExpression</a></li>
                  </ol>
              </div>
        </div>
        <div id="page">
          <div id="page-content">
            <div id="main-content">

<h1>setExpression</h1>
<p>Method of <a href="/docs/css/cssom/methods">css/cssom/methods</a><a href="/docs/css/cssom/methods">css/cssom/methods</a></p>
<h2>Syntax</h2>
<pre><code class="js"><span class="hljs-keyword">var</span> object = object.setExpression(PropertyName, Expression, Language);
</code></pre>
<h2>Parameters</h2>
<h3>PropertyName</h3>
<dl>
<dt>Data-type</dt>
<dd>String
</dd>
</dl>
<p><strong>String</strong> that specifies the name of the property to which <em>expression</em> is added.</p>
<h3>Expression</h3>
<dl>
<dt>Data-type</dt>
<dd>String
</dd>
</dl>
<p><strong>String</strong> that specifies any valid script (JScript, JavaScript, VBSCript) statement without quotations or semicolons. This string can include references to other properties on the current page. Array references are not allowed on object properties included in this script.</p>
<h3>Language</h3>
<dl>
<dt>Data-type</dt>
<dd>String
</dd>
</dl>
<p><strong>String</strong> that specifies one of the following values:</p>
<ul>
<li>“JScript” – Default. Language is JScript.</li>
<li>“VBScript” --Language is VBScript.</li>
<li>“JavaScript” – Language is JavaScript.</li>
</ul>
<h2>Return Value</h2>
<p>Returns an object of type DOM NodeDOM Node</p>
<h2>Examples</h2>
<p>The following examples use the <strong>setExpression</strong> method to change the width of a blue box. In each example, the width of the blue box is equal to the sum of the values of the first two text boxes. When a value in one of the text boxes changes, the width of the blue box recalculates.</p>
<p>This example shows the HTML implementation of <strong>setExpression</strong>.</p>
<pre><code class="html"><span class="hljs-tag">&lt;<span class="hljs-title">INPUT</span> <span class="hljs-attribute">TYPE</span>=<span class="hljs-value">text</span> <span class="hljs-attribute">ID</span>=<span class="hljs-value">oBox1</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">40</span>&gt;</span>The sum of the values in
    these two text boxes determines the width<span class="hljs-tag">&lt;<span class="hljs-title">BR</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">INPUT</span> <span class="hljs-attribute">TYPE</span>=<span class="hljs-value">text</span> <span class="hljs-attribute">ID</span>=<span class="hljs-value">oBox2</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">40</span>&gt;</span>of the blue text box below.
<span class="hljs-tag">&lt;<span class="hljs-title">BR</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">INPUT</span> <span class="hljs-attribute">TYPE</span>=<span class="hljs-value">text</span> <span class="hljs-attribute">ID</span>=<span class="hljs-value">oBox3</span>
    <span class="hljs-attribute">STYLE</span>=<span class="hljs-value">"width:expression(eval(oBox1.value) +
    eval(oBox2.value));background-color:blue"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">BR</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">INPUT</span> <span class="hljs-attribute">TYPE</span>=<span class="hljs-value">button</span> <span class="hljs-attribute">ID</span>=<span class="hljs-value">Button</span>
    <span class="hljs-attribute">value</span>=<span class="hljs-value">"Click to resize blue box above"</span>
    <span class="hljs-attribute">onclick</span>=<span class="hljs-value">"recalc()"</span>&gt;</span>
</code></pre>
<p><a href="http://samples.msdn.microsoft.com/workshop/samples/author/dhtml/refs/recalc_inline.htm">View live example</a></p>
<p>This example uses the <a href="/docs/dom/HTMLElement/uniqueID"><strong>uniqueID</strong></a> property and the <strong>setExpression</strong> method to update the <a href="/dom/HTMLElement/innerText"><strong>innerText</strong></a> property of a table row.</p>
<pre><code class="js">&lt;SCRIPT&gt;
window.onload=fnInit;
function fnInit(){
   var iLen=oSheet.rows.length-1;
   for(var i=1;i&lt;iLen;i++){
      var oRow=oSheet.rows[i];
      var oCells=oRow.cells;
      oCells(3).setExpression("innerText",
         "fnGetValue(" + oRow.uniqueID + ")");
   }
   var oGrand=oSheet.rows(iLen).cells(1);
   oGrand.setExpression("innerText","fnGetTotal()");
}
function fnGetTotal(){
   var iValue=0;
   var iLen=oSheet.rows.length-1;
   for(var i=1;i&lt;iLen;i++){
      iValue+=parseFloat(oSheet.rows(i).cells(3).innerText);
   }
   return iValue;
}
function fnGetValue(oRow){
   var oCells=oRow.cells;
   var oPrice=oCells(2);
   var oQuantity=oCells(1);
   var sPrice;
   var sQuantity;
   if(oPrice.childNodes[0].nodeName=="#text"){
      sPrice=oPrice.innerText;
   }
   else{
      var vPrice=oPrice.childNodes[0].value;
      sPrice=(vPrice==""?"0":vPrice);
   }
   if(oQuantity.childNodes[0].nodeName=="#text"){
      sQuantity=oQuantity.innerText;
   }
   else{
      var vQuantity=oQuantity.childNodes[0].value;
      sQuantity=(vQuantity==""?"0":vQuantity);
   }
   var vAlg1=parseFloat(sPrice) * parseFloat(sQuantity);
   return vAlg1;
}
&lt;/SCRIPT&gt;
&lt;TABLE ID="oSheet"&gt;
&lt;TR&gt;&lt;TH&gt;Product&lt;/TH&gt;&lt;TH&gt;Quantity&lt;/TH&gt;
&lt;TH&gt;Price per #&lt;/TH&gt;&lt;TH&gt;Totals&lt;/TH&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD&gt;Browser Putty&lt;/TD&gt;&lt;TD EDIT="true"&gt;2&lt;/TD&gt;
&lt;TD EDIT="true"&gt;4.99&lt;/TD&gt;&lt;TD&gt;&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TH COLSPAN=3&gt;Grand Total&lt;/TH&gt;&lt;TH&gt;&lt;/TH&gt;&lt;/TR&gt;
&lt;/TABLE&gt;
</code></pre>
<p><a href="http://samples.msdn.microsoft.com/workshop/samples/author/dhtml/refs/setExpression.htm">View live example</a></p>
<h2>Notes</h2>
<h3>Remarks</h3>
<p>Use the <strong>setExpression</strong> method to add expressions to supported <a href="/docs/css/cssom/methods/removeExpression"><strong>removeExpression</strong></a> method. The following syntax sections show how to set an expression on DHTML Properties and CSS attributes.</p>
<ul>
<li>Use this syntax to set an expression on a read/write property or on an <strong>expando</strong> property.</li>
</ul>
<p>&lt;div class{{=}}&quot;codeSnippet&quot;&gt; &lt;pre xml:space{{=}}&quot;preserve&quot;&gt;&lt;code&gt;object.setExpression(sPropertyName, sExpression, sLanguage)&lt;/code&gt;&lt;/pre&gt; &lt;/div&gt;</p>
<ul>
<li>Use this syntax to set an expression on a CSS attribute.</li>
</ul>
<p>&lt;div class{{=}}&quot;codeSnippet&quot;&gt; &lt;pre xml:space{{=}}&quot;preserve&quot;&gt;&lt;code&gt;object.style.setExpression(sPropertyName, sExpression, sLanguage)&lt;/code&gt;&lt;/pre&gt; &lt;/div&gt;</p>
<ul>
<li>Use the <strong>expression()</strong> syntax to set an expression on a CSS attribute in HTML.</li>
</ul>
<p>&lt;div class{{=}}&quot;codeSnippet&quot;&gt; &lt;pre xml:space{{=}}&quot;preserve&quot;&gt;&lt;code&gt;&lt;ELEMENT STYLE{{=}}&quot;sAttributeName:expression(sExpression)&quot;&gt;&lt;/code&gt;&lt;/pre&gt; &lt;/div&gt; The data type of the evaluated expression in the <em>language</em> parameter must match one of the possible values allowed for the <em>expression</em> parameter. If the property or attribute specified by the first parameter requires a string, the data type of the second parameter must be a string. Otherwise, the second parameter is evaluated prior to invoking <strong>setExpression</strong>, causing the expression to be set to the result of the evaluation. Use the <a href="/docs/dom/HTMLElement/uniqueID"><strong>uniqueID</strong></a> property of an object in an expression to refer back to the object. Using <strong>uniqueID</strong> is an alternative to specifying an <a href="/docs/html/attributes/id"><strong>id</strong></a> for expressions that use an object reference. The <a href="/docs/css/cssom/styleSheet/cssText"><strong>cssText</strong></a> property is a unique property that is not compatible with the dynamic properties implementation. Do not use <strong>cssText</strong> with any dynamic property methods. The following examples illustrate common problems encountered with the <em>expression</em> parameter in <strong>setExpression</strong>. The <em>expression</em> appears valid, but may not be.</p>
<ul>
<li>The provided <em>expression</em> is invalid because document.style.fontSize is “npx” and will not add to 13</li>
</ul>
<p><code>object.style.setExpression(&quot;height&quot;,&quot;document.style.fontSize + 13&quot;);</code></p>
<ul>
<li>The provided <em>expression</em> is invalid when document.body.style.fontSize is previously unspecified</li>
</ul>
<p><code>object.style.setExpression(&quot;width&quot;,&quot;document.body.style.fontSize&quot;);</code></p>
<h2>See also</h2>
<h3>Related pages</h3>
<ul>
<li><code>IHTMLElement2</code></li>
<li><code>IHTMLStyle2</code></li>
<li>currentStyle<a href="/docs/css/cssom/currentStyle">currentStyle</a></li>
<li>runtimeStyle<a href="/docs/css/cssom/runtimeStyle">runtimeStyle</a></li>
<li>style<a href="/docs/css/cssom/style">style</a></li>
<li><code>Reference</code></li>
<li>getExpression<a href="/docs/css/cssom/methods/getExpression">getExpression</a></li>
<li>removeExpression<a href="/docs/css/cssom/methods/removeExpression">removeExpression</a></li>
<li><code>Conceptual</code></li>
<li><code>About Dynamic Properties</code></li>
</ul>

<h2>Attributions</h2>
<ul>
	<li><p>Microsoft Developer Network: [<a href="http://msdn.microsoft.com/en-us/library/ie/hh828809%28v=vs.85%29.aspx">Windows Internet Explorer API reference</a> Article]</p>
</li>
</ul>
            </div>
            <div class="topics-nav">
              <ul>
                <li><a href="/docs/Beginners">Beginners</a></li>
                <li><a href="/docs/concepts">Concepts</a></li>
                <li><a href="/docs/html">HTML</a></li>
                <li><a href="/docs/css">CSS</a></li>
                <li><a href="/docs/concepts/accessibility">Accessibility</a></li>
                <li><a href="/docs/javascript">JavaScript</a></li>
                <li><a href="/docs/dom">DOM</a></li>
                <li><a href="/docs/svg">SVG</a></li>
              </ul>
            </div>
            <div class="clear"></div>
          </div>
        </div>
      </div>
    </div>
    <footer id="mw-footer">
      <div class="container">
        <div id="footer-wordmark">
          <a href="https://github.com/webplatform/docs/blob/master/LICENSE.md" class="license">
            <img src="/assets/cc-by-black.svg" width="120" height="42" alt="Content available under CC-BY, except where otherwise noted.">
          </a>
          <a href="/"><span id="footer-title">WebPlatform<span id="footer-title-light">.org</span></span></a>
        </div>
        <!-- ul class="stewards">
          <li class="steward-w3c"><a href="/stewards/w3c">W3C</a></li>
        </ul -->
      </div>
    </footer>
    <script src="/assets/js/docs.js"></script>
  </body>
</html>
